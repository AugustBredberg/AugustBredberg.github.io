{"ast":null,"code":"import { Directive, ElementRef, Input, Output, EventEmitter } from '@angular/core';\nimport { CustomEvent } from './custom-event-polyfill';\nimport * as Éµngcc0 from '@angular/core';\n\nvar MaterializeDirective = function () {\n  /**\n   * @param {?} _el\n   */\n  function MaterializeDirective(_el) {\n    this._el = _el;\n    this._params = null;\n    this._functionName = null;\n    this.previousValue = null;\n    this.previousDisabled = false;\n    this._waitFunction = {};\n    this.changeListenerShouldBeAdded = true;\n    this.init = new EventEmitter();\n    this.initialized = false;\n  }\n\n  Object.defineProperty(MaterializeDirective.prototype, \"materializeParams\", {\n    /**\n     * @param {?} params\n     * @return {?}\n     */\n    set: function (params) {\n      this._params = params;\n      this.performElementUpdates();\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(MaterializeDirective.prototype, \"materializeActions\", {\n    /**\n     * @param {?} actions\n     * @return {?}\n     */\n    set: function (actions) {\n      var _this = this;\n\n      actions.subscribe(function (action) {\n        window.setTimeout(function () {\n          if (typeof action === \"string\") {\n            _this.performLocalElementUpdates(action);\n          } else {\n            _this.performLocalElementUpdates(action.action, action.params);\n          }\n        }, 1);\n      });\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(MaterializeDirective.prototype, \"materialize\", {\n    /**\n     * @param {?} functionName\n     * @return {?}\n     */\n    set: function (functionName) {\n      this._functionName = functionName;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(MaterializeDirective.prototype, \"materializeSelectOptions\", {\n    /**\n     * @param {?} options\n     * @return {?}\n     */\n    set: function (options) {},\n    enumerable: true,\n    configurable: true\n  });\n  /**\n   * @return {?}\n   */\n\n  MaterializeDirective.prototype.ngAfterViewInit = function () {\n    this.performElementUpdates();\n  };\n  /**\n   * @param {?=} _unused\n   * @return {?}\n   */\n\n\n  MaterializeDirective.prototype.ngOnChanges = function (_unused) {\n    var _this = this;\n\n    if (this.isSelect()) {\n      setTimeout(function () {\n        return _this.performLocalElementUpdates();\n      }, 10);\n    }\n  };\n  /**\n   * @return {?}\n   */\n\n\n  MaterializeDirective.prototype.ngOnDestroy = function () {\n    this.performElementRemotion();\n  };\n  /**\n   * @return {?}\n   */\n\n\n  MaterializeDirective.prototype.ngDoCheck = function () {\n    var\n    /** @type {?} */\n    nativeElement = this._el.nativeElement;\n    var\n    /** @type {?} */\n    jQueryElement = $(nativeElement);\n\n    if (this.isSelect()) {\n      var\n      /** @type {?} */\n      shouldUpdate = false;\n\n      if (nativeElement.disabled != this.previousDisabled) {\n        this.previousDisabled = nativeElement.disabled;\n        shouldUpdate = true;\n      }\n\n      if (!jQueryElement.attr(\"multiple\") && nativeElement.value != this.previousValue) {\n        // handle select changes of the model\n        this.previousValue = nativeElement.value;\n        shouldUpdate = true;\n      }\n\n      if (shouldUpdate) {\n        this.performLocalElementUpdates();\n      }\n    } else if (this.isTextarea()) {\n      if (nativeElement.value != this.previousValue) {\n        this.previousValue = nativeElement.value;\n        this.performElementUpdates();\n      }\n    }\n\n    return false;\n  };\n  /**\n   * @return {?}\n   */\n\n\n  MaterializeDirective.prototype.performElementRemotion = function () {\n    if (this.isTooltip()) {\n      var\n      /** @type {?} */\n      nativeElement = this._el.nativeElement;\n      var\n      /** @type {?} */\n      jQueryElement = $(nativeElement);\n      var\n      /** @type {?} */\n      tooltipId = jQueryElement.attr('data-tooltip-id');\n\n      if (tooltipId) {\n        $('#' + tooltipId).remove();\n      }\n    }\n  };\n  /**\n   * @return {?}\n   */\n\n\n  MaterializeDirective.prototype.performElementUpdates = function () {\n    var _this = this; // it should have been created by now, but confirm anyway\n\n\n    if (Materialize && Materialize.updateTextFields) {\n      Materialize.updateTextFields();\n    } // handle select changes from the HTML\n\n\n    if (this.isSelect() && this.changeListenerShouldBeAdded) {\n      var\n      /** @type {?} */\n      nativeElement_1 = this._el.nativeElement;\n      var\n      /** @type {?} */\n      jQueryElement = $(nativeElement_1);\n      jQueryElement.on(\"change\", function (e) {\n        if (!e.originalEvent || !e.originalEvent.internalToMaterialize) {\n          var\n          /** @type {?} */\n          event_1 = document.createEvent(\"CustomEvent\"); //if (jQueryElement.attr(\"multiple\")) {\n          //event.initCustomEvent(\"input\",false,false,undefined);\n          //}\n          //else {\n\n          event_1.initCustomEvent(\"change\", false, false, undefined); //}\n\n          event_1.internalToMaterialize = true;\n          nativeElement_1.dispatchEvent(event_1);\n        }\n      });\n      this.changeListenerShouldBeAdded = false;\n    }\n\n    if (this.isAutocomplete()) {\n      var\n      /** @type {?} */\n      nativeElement_2 = this._el.nativeElement;\n      var\n      /** @type {?} */\n      jQueryElement = $(nativeElement_2);\n      jQueryElement.on(\"change\", function (e) {\n        return nativeElement_2.dispatchEvent(CustomEvent(\"input\"));\n      });\n    }\n\n    if (this.isDatePicker()) {\n      var\n      /** @type {?} */\n      nativeElement_3 = this._el.nativeElement;\n      var\n      /** @type {?} */\n      jqueryPickerElement_1 = $(nativeElement_3);\n\n      var\n      /** @type {?} */\n      datePicker = jqueryPickerElement_1[this._functionName].apply(jqueryPickerElement_1, this._params);\n\n      var\n      /** @type {?} */\n      picker_1 = datePicker.pickadate('picker');\n      setTimeout(function () {\n        if (_this.ngModel) {\n          picker_1.set('select', _this.ngModel);\n        } else {\n          var\n          /** @type {?} */\n          value = jqueryPickerElement_1.val();\n\n          if (value && value.length > 0) {\n            picker_1.set('select', value);\n          }\n        }\n\n        jqueryPickerElement_1.on('change', function (e) {\n          return nativeElement_3.dispatchEvent(CustomEvent(\"input\"));\n        });\n      });\n    }\n\n    if (this.isTimePicker()) {\n      var\n      /** @type {?} */\n      nativeElement_4 = this._el.nativeElement;\n      var\n      /** @type {?} */\n      jqueryPickerElement_2 = $(nativeElement_4);\n\n      var\n      /** @type {?} */\n      timePicker = jqueryPickerElement_2[this._functionName].apply(jqueryPickerElement_2, this._params);\n\n      var\n      /** @type {?} */\n      picker_2 = timePicker.pickatime('picker');\n      setTimeout(function () {\n        if (_this.ngModel) {\n          picker_2.val(_this.ngModel);\n        } else {\n          picker_2.val(jqueryPickerElement_2.val());\n        }\n\n        jqueryPickerElement_2.on('change', function (e) {\n          return nativeElement_4.dispatchEvent(CustomEvent(\"input\"));\n        });\n      });\n    }\n\n    if (this.isChips()) {\n      var\n      /** @type {?} */\n      nativeElement_5 = this._el.nativeElement;\n      var\n      /** @type {?} */\n      jQueryElement = $(nativeElement_5);\n      jQueryElement.on(\"chip.add\", function (e, chip) {\n        return nativeElement_5.dispatchEvent(CustomEvent(\"chip.add\", chip));\n      });\n      jQueryElement.on(\"chip.delete\", function (e, chip) {\n        return nativeElement_5.dispatchEvent(CustomEvent(\"chip.delete\", chip));\n      });\n      jQueryElement.on(\"chip.select\", function (e, chip) {\n        return nativeElement_5.dispatchEvent(CustomEvent(\"chip.select\", chip));\n      });\n    }\n\n    if (this.isTextarea()) {\n      this._el.nativeElement.dispatchEvent(CustomEvent(\"autoresize\", {\n        bubbles: true,\n        cancelable: false,\n        detail: undefined\n      }));\n    }\n\n    this.performLocalElementUpdates();\n  };\n  /**\n   * @param {?=} functionName\n   * @param {?=} params\n   * @return {?}\n   */\n\n\n  MaterializeDirective.prototype.performLocalElementUpdates = function (functionName, params) {\n    var _this = this;\n\n    if (functionName === void 0) {\n      functionName = this._functionName;\n    }\n\n    if (params === void 0) {\n      params = this._params;\n    }\n\n    if (this._waitFunction[functionName]) {\n      return;\n    }\n\n    this._waitFunction[functionName] = true;\n    $(document).ready(function () {\n      _this._waitFunction[functionName] = false;\n\n      if (functionName) {\n        var\n        /** @type {?} */\n        jQueryElement = $(_this._el.nativeElement);\n\n        if (jQueryElement[functionName]) {\n          if (params) {\n            if (params instanceof Array) {\n              jQueryElement[functionName].apply(jQueryElement, params);\n            } else {\n              throw new Error(\"Params has to be an array.\");\n            }\n          } else {\n            jQueryElement[functionName]();\n          }\n        } else {\n          // fallback to running this function on the global Materialize object\n          if (Materialize[functionName]) {\n            if (params) {\n              if (params instanceof Array) {\n                Materialize[functionName].apply(Materialize, params);\n              } else {\n                throw new Error(\"Params has to be an array.\");\n              }\n            } else {\n              Materialize[functionName]();\n            }\n          } else {\n            throw new Error(\"Couldn't find materialize function ''\" + functionName + \"' on element or the global Materialize object.\");\n          }\n        }\n\n        if (!_this.initialized) {\n          _this.initialized = true;\n\n          _this.init.emit();\n        }\n      }\n    });\n  };\n  /**\n   * @return {?}\n   */\n\n\n  MaterializeDirective.prototype.isTooltip = function () {\n    return this._functionName && this._functionName === \"tooltip\";\n  };\n  /**\n   * @return {?}\n   */\n\n\n  MaterializeDirective.prototype.isSelect = function () {\n    return this._functionName && this._functionName === \"material_select\";\n  };\n  /**\n   * @return {?}\n   */\n\n\n  MaterializeDirective.prototype.isDatePicker = function () {\n    return this._functionName && this._functionName === \"pickadate\";\n  };\n  /**\n   * @return {?}\n   */\n\n\n  MaterializeDirective.prototype.isTimePicker = function () {\n    return this._functionName && this._functionName === \"pickatime\";\n  };\n  /**\n   * @return {?}\n   */\n\n\n  MaterializeDirective.prototype.isChips = function () {\n    return this._functionName && this._functionName === \"material_chip\";\n  };\n  /**\n   * @return {?}\n   */\n\n\n  MaterializeDirective.prototype.isAutocomplete = function () {\n    return this._functionName && this._functionName === \"autocomplete\";\n  };\n  /**\n   * @return {?}\n   */\n\n\n  MaterializeDirective.prototype.isTextarea = function () {\n    return this._el.nativeElement.nodeName == \"TEXTAREA\";\n  };\n  /**\n   * @return {?}\n   */\n\n\n  MaterializeDirective.prototype.enableDPButtons = function () {\n    $('.picker__clear').removeAttr(\"disabled\");\n    $('.picker__today').removeAttr(\"disabled\");\n    $('.picker__close').removeAttr(\"disabled\");\n    $('.picker__select--year').removeAttr(\"disabled\");\n    $('.picker__select--month').removeAttr(\"disabled\");\n  };\n\n  MaterializeDirective.Éµfac = function MaterializeDirective_Factory(t) {\n    return new (t || MaterializeDirective)(Éµngcc0.ÉµÉµdirectiveInject(Éµngcc0.ElementRef));\n  };\n\n  MaterializeDirective.Éµdir = /*@__PURE__*/Éµngcc0.ÉµÉµdefineDirective({\n    type: MaterializeDirective,\n    selectors: [[\"\", \"materialize\", \"\"]],\n    inputs: {\n      materializeParams: \"materializeParams\",\n      materializeActions: \"materializeActions\",\n      materialize: \"materialize\",\n      materializeSelectOptions: \"materializeSelectOptions\",\n      ngModel: \"ngModel\"\n    },\n    outputs: {\n      init: \"init\"\n    },\n    features: [Éµngcc0.ÉµÉµNgOnChangesFeature]\n  });\n\n  (function () {\n    (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n  })();\n\n  return MaterializeDirective;\n}();\n\nexport { MaterializeDirective };\n/**\n * @nocollapse\n */\n\nMaterializeDirective.ctorParameters = function () {\n  return [{\n    type: ElementRef\n  }];\n};\n\nMaterializeDirective.propDecorators = {\n  'init': [{\n    type: Output\n  }],\n  'materializeParams': [{\n    type: Input\n  }],\n  'materializeActions': [{\n    type: Input\n  }],\n  'materialize': [{\n    type: Input\n  }],\n  'materializeSelectOptions': [{\n    type: Input\n  }],\n  'ngModel': [{\n    type: Input\n  }]\n};\n\nfunction MaterializeDirective_tsickle_Closure_declarations() {\n  /** @type {?} */\n  MaterializeDirective.decorators;\n  /**\n   * @nocollapse\n   * @type {?}\n   */\n\n  MaterializeDirective.ctorParameters;\n  /** @type {?} */\n\n  MaterializeDirective.propDecorators;\n  /** @type {?} */\n\n  MaterializeDirective.prototype._params;\n  /** @type {?} */\n\n  MaterializeDirective.prototype._functionName;\n  /** @type {?} */\n\n  MaterializeDirective.prototype.previousValue;\n  /** @type {?} */\n\n  MaterializeDirective.prototype.previousDisabled;\n  /** @type {?} */\n\n  MaterializeDirective.prototype._waitFunction;\n  /** @type {?} */\n\n  MaterializeDirective.prototype.changeListenerShouldBeAdded;\n  /** @type {?} */\n\n  MaterializeDirective.prototype.init;\n  /** @type {?} */\n\n  MaterializeDirective.prototype.initialized;\n  /** @type {?} */\n\n  MaterializeDirective.prototype.ngModel;\n  /** @type {?} */\n\n  MaterializeDirective.prototype._el;\n} //# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWF0ZXJpYWxpemUtZGlyZWN0aXZlLmpzIiwic291cmNlcyI6WyJtYXRlcmlhbGl6ZS1kaXJlY3RpdmUuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7OztvQkFBTTtBQUNOO0FBQ0E7QUFDQSxnQ0FLRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IERpcmVjdGl2ZSwgRWxlbWVudFJlZiwgSW5wdXQsIE91dHB1dCwgRXZlbnRFbWl0dGVyIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBDdXN0b21FdmVudCB9IGZyb20gJy4vY3VzdG9tLWV2ZW50LXBvbHlmaWxsJztcbnZhciBNYXRlcmlhbGl6ZURpcmVjdGl2ZSA9IChmdW5jdGlvbiAoKSB7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHs/fSBfZWxcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBNYXRlcmlhbGl6ZURpcmVjdGl2ZShfZWwpIHtcbiAgICAgICAgdGhpcy5fZWwgPSBfZWw7XG4gICAgICAgIHRoaXMuX3BhcmFtcyA9IG51bGw7XG4gICAgICAgIHRoaXMuX2Z1bmN0aW9uTmFtZSA9IG51bGw7XG4gICAgICAgIHRoaXMucHJldmlvdXNWYWx1ZSA9IG51bGw7XG4gICAgICAgIHRoaXMucHJldmlvdXNEaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLl93YWl0RnVuY3Rpb24gPSB7fTtcbiAgICAgICAgdGhpcy5jaGFuZ2VMaXN0ZW5lclNob3VsZEJlQWRkZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLmluaXQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgICAgIHRoaXMuaW5pdGlhbGl6ZWQgPSBmYWxzZTtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE1hdGVyaWFsaXplRGlyZWN0aXZlLnByb3RvdHlwZSwgXCJtYXRlcmlhbGl6ZVBhcmFtc1wiLCB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAcGFyYW0gez99IHBhcmFtc1xuICAgICAgICAgKiBAcmV0dXJuIHs/fVxuICAgICAgICAgKi9cbiAgICAgICAgc2V0OiBmdW5jdGlvbiAocGFyYW1zKSB7XG4gICAgICAgICAgICB0aGlzLl9wYXJhbXMgPSBwYXJhbXM7XG4gICAgICAgICAgICB0aGlzLnBlcmZvcm1FbGVtZW50VXBkYXRlcygpO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTWF0ZXJpYWxpemVEaXJlY3RpdmUucHJvdG90eXBlLCBcIm1hdGVyaWFsaXplQWN0aW9uc1wiLCB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAcGFyYW0gez99IGFjdGlvbnNcbiAgICAgICAgICogQHJldHVybiB7P31cbiAgICAgICAgICovXG4gICAgICAgIHNldDogZnVuY3Rpb24gKGFjdGlvbnMpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICBhY3Rpb25zLnN1YnNjcmliZShmdW5jdGlvbiAoYWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGFjdGlvbiA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMucGVyZm9ybUxvY2FsRWxlbWVudFVwZGF0ZXMoYWN0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnBlcmZvcm1Mb2NhbEVsZW1lbnRVcGRhdGVzKGFjdGlvbi5hY3Rpb24sIGFjdGlvbi5wYXJhbXMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSwgMSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE1hdGVyaWFsaXplRGlyZWN0aXZlLnByb3RvdHlwZSwgXCJtYXRlcmlhbGl6ZVwiLCB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAcGFyYW0gez99IGZ1bmN0aW9uTmFtZVxuICAgICAgICAgKiBAcmV0dXJuIHs/fVxuICAgICAgICAgKi9cbiAgICAgICAgc2V0OiBmdW5jdGlvbiAoZnVuY3Rpb25OYW1lKSB7XG4gICAgICAgICAgICB0aGlzLl9mdW5jdGlvbk5hbWUgPSBmdW5jdGlvbk5hbWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShNYXRlcmlhbGl6ZURpcmVjdGl2ZS5wcm90b3R5cGUsIFwibWF0ZXJpYWxpemVTZWxlY3RPcHRpb25zXCIsIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBwYXJhbSB7P30gb3B0aW9uc1xuICAgICAgICAgKiBAcmV0dXJuIHs/fVxuICAgICAgICAgKi9cbiAgICAgICAgc2V0OiBmdW5jdGlvbiAob3B0aW9ucykge1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJuIHs/fVxuICAgICAqL1xuICAgIE1hdGVyaWFsaXplRGlyZWN0aXZlLnByb3RvdHlwZS5uZ0FmdGVyVmlld0luaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMucGVyZm9ybUVsZW1lbnRVcGRhdGVzKCk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0gez89fSBfdW51c2VkXG4gICAgICogQHJldHVybiB7P31cbiAgICAgKi9cbiAgICBNYXRlcmlhbGl6ZURpcmVjdGl2ZS5wcm90b3R5cGUubmdPbkNoYW5nZXMgPSBmdW5jdGlvbiAoX3VudXNlZCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAodGhpcy5pc1NlbGVjdCgpKSB7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLnBlcmZvcm1Mb2NhbEVsZW1lbnRVcGRhdGVzKCk7IH0sIDEwKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybiB7P31cbiAgICAgKi9cbiAgICBNYXRlcmlhbGl6ZURpcmVjdGl2ZS5wcm90b3R5cGUubmdPbkRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMucGVyZm9ybUVsZW1lbnRSZW1vdGlvbigpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybiB7P31cbiAgICAgKi9cbiAgICBNYXRlcmlhbGl6ZURpcmVjdGl2ZS5wcm90b3R5cGUubmdEb0NoZWNrID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgLyoqIEB0eXBlIHs/fSAqLyBuYXRpdmVFbGVtZW50ID0gdGhpcy5fZWwubmF0aXZlRWxlbWVudDtcbiAgICAgICAgdmFyIC8qKiBAdHlwZSB7P30gKi8galF1ZXJ5RWxlbWVudCA9ICQobmF0aXZlRWxlbWVudCk7XG4gICAgICAgIGlmICh0aGlzLmlzU2VsZWN0KCkpIHtcbiAgICAgICAgICAgIHZhciAvKiogQHR5cGUgez99ICovIHNob3VsZFVwZGF0ZSA9IGZhbHNlO1xuICAgICAgICAgICAgaWYgKG5hdGl2ZUVsZW1lbnQuZGlzYWJsZWQgIT0gdGhpcy5wcmV2aW91c0Rpc2FibGVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcmV2aW91c0Rpc2FibGVkID0gbmF0aXZlRWxlbWVudC5kaXNhYmxlZDtcbiAgICAgICAgICAgICAgICBzaG91bGRVcGRhdGUgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFqUXVlcnlFbGVtZW50LmF0dHIoXCJtdWx0aXBsZVwiKSAmJiBuYXRpdmVFbGVtZW50LnZhbHVlICE9IHRoaXMucHJldmlvdXNWYWx1ZSkge1xuICAgICAgICAgICAgICAgIC8vIGhhbmRsZSBzZWxlY3QgY2hhbmdlcyBvZiB0aGUgbW9kZWxcbiAgICAgICAgICAgICAgICB0aGlzLnByZXZpb3VzVmFsdWUgPSBuYXRpdmVFbGVtZW50LnZhbHVlO1xuICAgICAgICAgICAgICAgIHNob3VsZFVwZGF0ZSA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc2hvdWxkVXBkYXRlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wZXJmb3JtTG9jYWxFbGVtZW50VXBkYXRlcygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuaXNUZXh0YXJlYSgpKSB7XG4gICAgICAgICAgICBpZiAobmF0aXZlRWxlbWVudC52YWx1ZSAhPSB0aGlzLnByZXZpb3VzVmFsdWUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByZXZpb3VzVmFsdWUgPSBuYXRpdmVFbGVtZW50LnZhbHVlO1xuICAgICAgICAgICAgICAgIHRoaXMucGVyZm9ybUVsZW1lbnRVcGRhdGVzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybiB7P31cbiAgICAgKi9cbiAgICBNYXRlcmlhbGl6ZURpcmVjdGl2ZS5wcm90b3R5cGUucGVyZm9ybUVsZW1lbnRSZW1vdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNUb29sdGlwKCkpIHtcbiAgICAgICAgICAgIHZhciAvKiogQHR5cGUgez99ICovIG5hdGl2ZUVsZW1lbnQgPSB0aGlzLl9lbC5uYXRpdmVFbGVtZW50O1xuICAgICAgICAgICAgdmFyIC8qKiBAdHlwZSB7P30gKi8galF1ZXJ5RWxlbWVudCA9ICQobmF0aXZlRWxlbWVudCk7XG4gICAgICAgICAgICB2YXIgLyoqIEB0eXBlIHs/fSAqLyB0b29sdGlwSWQgPSBqUXVlcnlFbGVtZW50LmF0dHIoJ2RhdGEtdG9vbHRpcC1pZCcpO1xuICAgICAgICAgICAgaWYgKHRvb2x0aXBJZCkge1xuICAgICAgICAgICAgICAgICQoJyMnICsgdG9vbHRpcElkKS5yZW1vdmUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybiB7P31cbiAgICAgKi9cbiAgICBNYXRlcmlhbGl6ZURpcmVjdGl2ZS5wcm90b3R5cGUucGVyZm9ybUVsZW1lbnRVcGRhdGVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAvLyBpdCBzaG91bGQgaGF2ZSBiZWVuIGNyZWF0ZWQgYnkgbm93LCBidXQgY29uZmlybSBhbnl3YXlcbiAgICAgICAgaWYgKE1hdGVyaWFsaXplICYmIE1hdGVyaWFsaXplLnVwZGF0ZVRleHRGaWVsZHMpIHtcbiAgICAgICAgICAgIE1hdGVyaWFsaXplLnVwZGF0ZVRleHRGaWVsZHMoKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBoYW5kbGUgc2VsZWN0IGNoYW5nZXMgZnJvbSB0aGUgSFRNTFxuICAgICAgICBpZiAodGhpcy5pc1NlbGVjdCgpICYmIHRoaXMuY2hhbmdlTGlzdGVuZXJTaG91bGRCZUFkZGVkKSB7XG4gICAgICAgICAgICB2YXIgLyoqIEB0eXBlIHs/fSAqLyBuYXRpdmVFbGVtZW50XzEgPSB0aGlzLl9lbC5uYXRpdmVFbGVtZW50O1xuICAgICAgICAgICAgdmFyIC8qKiBAdHlwZSB7P30gKi8galF1ZXJ5RWxlbWVudCA9ICQobmF0aXZlRWxlbWVudF8xKTtcbiAgICAgICAgICAgIGpRdWVyeUVsZW1lbnQub24oXCJjaGFuZ2VcIiwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoIWUub3JpZ2luYWxFdmVudCB8fCAhZS5vcmlnaW5hbEV2ZW50LmludGVybmFsVG9NYXRlcmlhbGl6ZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgLyoqIEB0eXBlIHs/fSAqLyBldmVudF8xID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoXCJDdXN0b21FdmVudFwiKTtcbiAgICAgICAgICAgICAgICAgICAgLy9pZiAoalF1ZXJ5RWxlbWVudC5hdHRyKFwibXVsdGlwbGVcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9ldmVudC5pbml0Q3VzdG9tRXZlbnQoXCJpbnB1dFwiLGZhbHNlLGZhbHNlLHVuZGVmaW5lZCk7XG4gICAgICAgICAgICAgICAgICAgIC8vfVxuICAgICAgICAgICAgICAgICAgICAvL2Vsc2Uge1xuICAgICAgICAgICAgICAgICAgICBldmVudF8xLmluaXRDdXN0b21FdmVudChcImNoYW5nZVwiLCBmYWxzZSwgZmFsc2UsIHVuZGVmaW5lZCk7XG4gICAgICAgICAgICAgICAgICAgIC8vfVxuICAgICAgICAgICAgICAgICAgICBldmVudF8xLmludGVybmFsVG9NYXRlcmlhbGl6ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIG5hdGl2ZUVsZW1lbnRfMS5kaXNwYXRjaEV2ZW50KGV2ZW50XzEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5jaGFuZ2VMaXN0ZW5lclNob3VsZEJlQWRkZWQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5pc0F1dG9jb21wbGV0ZSgpKSB7XG4gICAgICAgICAgICB2YXIgLyoqIEB0eXBlIHs/fSAqLyBuYXRpdmVFbGVtZW50XzIgPSB0aGlzLl9lbC5uYXRpdmVFbGVtZW50O1xuICAgICAgICAgICAgdmFyIC8qKiBAdHlwZSB7P30gKi8galF1ZXJ5RWxlbWVudCA9ICQobmF0aXZlRWxlbWVudF8yKTtcbiAgICAgICAgICAgIGpRdWVyeUVsZW1lbnQub24oXCJjaGFuZ2VcIiwgZnVuY3Rpb24gKGUpIHsgcmV0dXJuIG5hdGl2ZUVsZW1lbnRfMi5kaXNwYXRjaEV2ZW50KCgoQ3VzdG9tRXZlbnQoXCJpbnB1dFwiKSkpKTsgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuaXNEYXRlUGlja2VyKCkpIHtcbiAgICAgICAgICAgIHZhciAvKiogQHR5cGUgez99ICovIG5hdGl2ZUVsZW1lbnRfMyA9IHRoaXMuX2VsLm5hdGl2ZUVsZW1lbnQ7XG4gICAgICAgICAgICB2YXIgLyoqIEB0eXBlIHs/fSAqLyBqcXVlcnlQaWNrZXJFbGVtZW50XzEgPSAkKG5hdGl2ZUVsZW1lbnRfMyk7XG4gICAgICAgICAgICB2YXIgLyoqIEB0eXBlIHs/fSAqLyBkYXRlUGlja2VyID0ganF1ZXJ5UGlja2VyRWxlbWVudF8xW3RoaXMuX2Z1bmN0aW9uTmFtZV0uYXBwbHkoanF1ZXJ5UGlja2VyRWxlbWVudF8xLCB0aGlzLl9wYXJhbXMpO1xuICAgICAgICAgICAgdmFyIC8qKiBAdHlwZSB7P30gKi8gcGlja2VyXzEgPSBkYXRlUGlja2VyLnBpY2thZGF0ZSgncGlja2VyJyk7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMubmdNb2RlbCkge1xuICAgICAgICAgICAgICAgICAgICBwaWNrZXJfMS5zZXQoJ3NlbGVjdCcsIF90aGlzLm5nTW9kZWwpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIC8qKiBAdHlwZSB7P30gKi8gdmFsdWUgPSBqcXVlcnlQaWNrZXJFbGVtZW50XzEudmFsKCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSAmJiB2YWx1ZS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwaWNrZXJfMS5zZXQoJ3NlbGVjdCcsIHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBqcXVlcnlQaWNrZXJFbGVtZW50XzEub24oJ2NoYW5nZScsIGZ1bmN0aW9uIChlKSB7IHJldHVybiBuYXRpdmVFbGVtZW50XzMuZGlzcGF0Y2hFdmVudCgoKEN1c3RvbUV2ZW50KFwiaW5wdXRcIikpKSk7IH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuaXNUaW1lUGlja2VyKCkpIHtcbiAgICAgICAgICAgIHZhciAvKiogQHR5cGUgez99ICovIG5hdGl2ZUVsZW1lbnRfNCA9IHRoaXMuX2VsLm5hdGl2ZUVsZW1lbnQ7XG4gICAgICAgICAgICB2YXIgLyoqIEB0eXBlIHs/fSAqLyBqcXVlcnlQaWNrZXJFbGVtZW50XzIgPSAkKG5hdGl2ZUVsZW1lbnRfNCk7XG4gICAgICAgICAgICB2YXIgLyoqIEB0eXBlIHs/fSAqLyB0aW1lUGlja2VyID0ganF1ZXJ5UGlja2VyRWxlbWVudF8yW3RoaXMuX2Z1bmN0aW9uTmFtZV0uYXBwbHkoanF1ZXJ5UGlja2VyRWxlbWVudF8yLCB0aGlzLl9wYXJhbXMpO1xuICAgICAgICAgICAgdmFyIC8qKiBAdHlwZSB7P30gKi8gcGlja2VyXzIgPSB0aW1lUGlja2VyLnBpY2thdGltZSgncGlja2VyJyk7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMubmdNb2RlbCkge1xuICAgICAgICAgICAgICAgICAgICBwaWNrZXJfMi52YWwoX3RoaXMubmdNb2RlbCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBwaWNrZXJfMi52YWwoanF1ZXJ5UGlja2VyRWxlbWVudF8yLnZhbCgpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAganF1ZXJ5UGlja2VyRWxlbWVudF8yLm9uKCdjaGFuZ2UnLCBmdW5jdGlvbiAoZSkgeyByZXR1cm4gbmF0aXZlRWxlbWVudF80LmRpc3BhdGNoRXZlbnQoKChDdXN0b21FdmVudChcImlucHV0XCIpKSkpOyB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmlzQ2hpcHMoKSkge1xuICAgICAgICAgICAgdmFyIC8qKiBAdHlwZSB7P30gKi8gbmF0aXZlRWxlbWVudF81ID0gdGhpcy5fZWwubmF0aXZlRWxlbWVudDtcbiAgICAgICAgICAgIHZhciAvKiogQHR5cGUgez99ICovIGpRdWVyeUVsZW1lbnQgPSAkKG5hdGl2ZUVsZW1lbnRfNSk7XG4gICAgICAgICAgICBqUXVlcnlFbGVtZW50Lm9uKFwiY2hpcC5hZGRcIiwgZnVuY3Rpb24gKGUsIGNoaXApIHsgcmV0dXJuIG5hdGl2ZUVsZW1lbnRfNS5kaXNwYXRjaEV2ZW50KCgoQ3VzdG9tRXZlbnQoXCJjaGlwLmFkZFwiLCBjaGlwKSkpKTsgfSk7XG4gICAgICAgICAgICBqUXVlcnlFbGVtZW50Lm9uKFwiY2hpcC5kZWxldGVcIiwgZnVuY3Rpb24gKGUsIGNoaXApIHsgcmV0dXJuIG5hdGl2ZUVsZW1lbnRfNS5kaXNwYXRjaEV2ZW50KCgoQ3VzdG9tRXZlbnQoXCJjaGlwLmRlbGV0ZVwiLCBjaGlwKSkpKTsgfSk7XG4gICAgICAgICAgICBqUXVlcnlFbGVtZW50Lm9uKFwiY2hpcC5zZWxlY3RcIiwgZnVuY3Rpb24gKGUsIGNoaXApIHsgcmV0dXJuIG5hdGl2ZUVsZW1lbnRfNS5kaXNwYXRjaEV2ZW50KCgoQ3VzdG9tRXZlbnQoXCJjaGlwLnNlbGVjdFwiLCBjaGlwKSkpKTsgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuaXNUZXh0YXJlYSgpKSB7XG4gICAgICAgICAgICB0aGlzLl9lbC5uYXRpdmVFbGVtZW50LmRpc3BhdGNoRXZlbnQoKChDdXN0b21FdmVudChcImF1dG9yZXNpemVcIiwge1xuICAgICAgICAgICAgICAgIGJ1YmJsZXM6IHRydWUsXG4gICAgICAgICAgICAgICAgY2FuY2VsYWJsZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgZGV0YWlsOiB1bmRlZmluZWRcbiAgICAgICAgICAgIH0pKSkpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucGVyZm9ybUxvY2FsRWxlbWVudFVwZGF0ZXMoKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7Pz19IGZ1bmN0aW9uTmFtZVxuICAgICAqIEBwYXJhbSB7Pz19IHBhcmFtc1xuICAgICAqIEByZXR1cm4gez99XG4gICAgICovXG4gICAgTWF0ZXJpYWxpemVEaXJlY3RpdmUucHJvdG90eXBlLnBlcmZvcm1Mb2NhbEVsZW1lbnRVcGRhdGVzID0gZnVuY3Rpb24gKGZ1bmN0aW9uTmFtZSwgcGFyYW1zKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmIChmdW5jdGlvbk5hbWUgPT09IHZvaWQgMCkgeyBmdW5jdGlvbk5hbWUgPSB0aGlzLl9mdW5jdGlvbk5hbWU7IH1cbiAgICAgICAgaWYgKHBhcmFtcyA9PT0gdm9pZCAwKSB7IHBhcmFtcyA9IHRoaXMuX3BhcmFtczsgfVxuICAgICAgICBpZiAodGhpcy5fd2FpdEZ1bmN0aW9uW2Z1bmN0aW9uTmFtZV0pIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl93YWl0RnVuY3Rpb25bZnVuY3Rpb25OYW1lXSA9IHRydWU7XG4gICAgICAgICQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIF90aGlzLl93YWl0RnVuY3Rpb25bZnVuY3Rpb25OYW1lXSA9IGZhbHNlO1xuICAgICAgICAgICAgaWYgKGZ1bmN0aW9uTmFtZSkge1xuICAgICAgICAgICAgICAgIHZhciAvKiogQHR5cGUgez99ICovIGpRdWVyeUVsZW1lbnQgPSAkKF90aGlzLl9lbC5uYXRpdmVFbGVtZW50KTtcbiAgICAgICAgICAgICAgICBpZiAoalF1ZXJ5RWxlbWVudFtmdW5jdGlvbk5hbWVdKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwYXJhbXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJhbXMgaW5zdGFuY2VvZiBBcnJheSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpRdWVyeUVsZW1lbnRbZnVuY3Rpb25OYW1lXS5hcHBseShqUXVlcnlFbGVtZW50LCBwYXJhbXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUGFyYW1zIGhhcyB0byBiZSBhbiBhcnJheS5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBqUXVlcnlFbGVtZW50W2Z1bmN0aW9uTmFtZV0oKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gZmFsbGJhY2sgdG8gcnVubmluZyB0aGlzIGZ1bmN0aW9uIG9uIHRoZSBnbG9iYWwgTWF0ZXJpYWxpemUgb2JqZWN0XG4gICAgICAgICAgICAgICAgICAgIGlmIChNYXRlcmlhbGl6ZVtmdW5jdGlvbk5hbWVdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFyYW1zKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmFtcyBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hdGVyaWFsaXplW2Z1bmN0aW9uTmFtZV0uYXBwbHkoTWF0ZXJpYWxpemUsIHBhcmFtcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJQYXJhbXMgaGFzIHRvIGJlIGFuIGFycmF5LlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXRlcmlhbGl6ZVtmdW5jdGlvbk5hbWVdKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDb3VsZG4ndCBmaW5kIG1hdGVyaWFsaXplIGZ1bmN0aW9uICcnXCIgKyBmdW5jdGlvbk5hbWUgKyBcIicgb24gZWxlbWVudCBvciB0aGUgZ2xvYmFsIE1hdGVyaWFsaXplIG9iamVjdC5cIik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCFfdGhpcy5pbml0aWFsaXplZCkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5pbml0aWFsaXplZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmluaXQuZW1pdCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJuIHs/fVxuICAgICAqL1xuICAgIE1hdGVyaWFsaXplRGlyZWN0aXZlLnByb3RvdHlwZS5pc1Rvb2x0aXAgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAodGhpcy5fZnVuY3Rpb25OYW1lICYmIHRoaXMuX2Z1bmN0aW9uTmFtZSA9PT0gXCJ0b29sdGlwXCIpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybiB7P31cbiAgICAgKi9cbiAgICBNYXRlcmlhbGl6ZURpcmVjdGl2ZS5wcm90b3R5cGUuaXNTZWxlY3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAodGhpcy5fZnVuY3Rpb25OYW1lICYmIHRoaXMuX2Z1bmN0aW9uTmFtZSA9PT0gXCJtYXRlcmlhbF9zZWxlY3RcIik7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJuIHs/fVxuICAgICAqL1xuICAgIE1hdGVyaWFsaXplRGlyZWN0aXZlLnByb3RvdHlwZS5pc0RhdGVQaWNrZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAodGhpcy5fZnVuY3Rpb25OYW1lICYmIHRoaXMuX2Z1bmN0aW9uTmFtZSA9PT0gXCJwaWNrYWRhdGVcIik7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJuIHs/fVxuICAgICAqL1xuICAgIE1hdGVyaWFsaXplRGlyZWN0aXZlLnByb3RvdHlwZS5pc1RpbWVQaWNrZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAodGhpcy5fZnVuY3Rpb25OYW1lICYmIHRoaXMuX2Z1bmN0aW9uTmFtZSA9PT0gXCJwaWNrYXRpbWVcIik7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJuIHs/fVxuICAgICAqL1xuICAgIE1hdGVyaWFsaXplRGlyZWN0aXZlLnByb3RvdHlwZS5pc0NoaXBzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gKHRoaXMuX2Z1bmN0aW9uTmFtZSAmJiB0aGlzLl9mdW5jdGlvbk5hbWUgPT09IFwibWF0ZXJpYWxfY2hpcFwiKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEByZXR1cm4gez99XG4gICAgICovXG4gICAgTWF0ZXJpYWxpemVEaXJlY3RpdmUucHJvdG90eXBlLmlzQXV0b2NvbXBsZXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gKHRoaXMuX2Z1bmN0aW9uTmFtZSAmJiB0aGlzLl9mdW5jdGlvbk5hbWUgPT09IFwiYXV0b2NvbXBsZXRlXCIpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybiB7P31cbiAgICAgKi9cbiAgICBNYXRlcmlhbGl6ZURpcmVjdGl2ZS5wcm90b3R5cGUuaXNUZXh0YXJlYSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2VsLm5hdGl2ZUVsZW1lbnQubm9kZU5hbWUgPT0gXCJURVhUQVJFQVwiO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybiB7P31cbiAgICAgKi9cbiAgICBNYXRlcmlhbGl6ZURpcmVjdGl2ZS5wcm90b3R5cGUuZW5hYmxlRFBCdXR0b25zID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAkKCcucGlja2VyX19jbGVhcicpLnJlbW92ZUF0dHIoXCJkaXNhYmxlZFwiKTtcbiAgICAgICAgJCgnLnBpY2tlcl9fdG9kYXknKS5yZW1vdmVBdHRyKFwiZGlzYWJsZWRcIik7XG4gICAgICAgICQoJy5waWNrZXJfX2Nsb3NlJykucmVtb3ZlQXR0cihcImRpc2FibGVkXCIpO1xuICAgICAgICAkKCcucGlja2VyX19zZWxlY3QtLXllYXInKS5yZW1vdmVBdHRyKFwiZGlzYWJsZWRcIik7XG4gICAgICAgICQoJy5waWNrZXJfX3NlbGVjdC0tbW9udGgnKS5yZW1vdmVBdHRyKFwiZGlzYWJsZWRcIik7XG4gICAgfTtcbiAgICByZXR1cm4gTWF0ZXJpYWxpemVEaXJlY3RpdmU7XG59KCkpO1xuZXhwb3J0IHsgTWF0ZXJpYWxpemVEaXJlY3RpdmUgfTtcbk1hdGVyaWFsaXplRGlyZWN0aXZlLmRlY29yYXRvcnMgPSBbXG4gICAgeyB0eXBlOiBEaXJlY3RpdmUsIGFyZ3M6IFt7XG4gICAgICAgICAgICAgICAgc2VsZWN0b3I6ICdbbWF0ZXJpYWxpemVdJ1xuICAgICAgICAgICAgfSxdIH0sXG5dO1xuLyoqXG4gKiBAbm9jb2xsYXBzZVxuICovXG5NYXRlcmlhbGl6ZURpcmVjdGl2ZS5jdG9yUGFyYW1ldGVycyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIFtcbiAgICB7IHR5cGU6IEVsZW1lbnRSZWYsIH0sXG5dOyB9O1xuTWF0ZXJpYWxpemVEaXJlY3RpdmUucHJvcERlY29yYXRvcnMgPSB7XG4gICAgJ2luaXQnOiBbeyB0eXBlOiBPdXRwdXQgfSxdLFxuICAgICdtYXRlcmlhbGl6ZVBhcmFtcyc6IFt7IHR5cGU6IElucHV0IH0sXSxcbiAgICAnbWF0ZXJpYWxpemVBY3Rpb25zJzogW3sgdHlwZTogSW5wdXQgfSxdLFxuICAgICdtYXRlcmlhbGl6ZSc6IFt7IHR5cGU6IElucHV0IH0sXSxcbiAgICAnbWF0ZXJpYWxpemVTZWxlY3RPcHRpb25zJzogW3sgdHlwZTogSW5wdXQgfSxdLFxuICAgICduZ01vZGVsJzogW3sgdHlwZTogSW5wdXQgfSxdLFxufTtcbmZ1bmN0aW9uIE1hdGVyaWFsaXplRGlyZWN0aXZlX3RzaWNrbGVfQ2xvc3VyZV9kZWNsYXJhdGlvbnMoKSB7XG4gICAgLyoqIEB0eXBlIHs/fSAqL1xuICAgIE1hdGVyaWFsaXplRGlyZWN0aXZlLmRlY29yYXRvcnM7XG4gICAgLyoqXG4gICAgICogQG5vY29sbGFwc2VcbiAgICAgKiBAdHlwZSB7P31cbiAgICAgKi9cbiAgICBNYXRlcmlhbGl6ZURpcmVjdGl2ZS5jdG9yUGFyYW1ldGVycztcbiAgICAvKiogQHR5cGUgez99ICovXG4gICAgTWF0ZXJpYWxpemVEaXJlY3RpdmUucHJvcERlY29yYXRvcnM7XG4gICAgLyoqIEB0eXBlIHs/fSAqL1xuICAgIE1hdGVyaWFsaXplRGlyZWN0aXZlLnByb3RvdHlwZS5fcGFyYW1zO1xuICAgIC8qKiBAdHlwZSB7P30gKi9cbiAgICBNYXRlcmlhbGl6ZURpcmVjdGl2ZS5wcm90b3R5cGUuX2Z1bmN0aW9uTmFtZTtcbiAgICAvKiogQHR5cGUgez99ICovXG4gICAgTWF0ZXJpYWxpemVEaXJlY3RpdmUucHJvdG90eXBlLnByZXZpb3VzVmFsdWU7XG4gICAgLyoqIEB0eXBlIHs/fSAqL1xuICAgIE1hdGVyaWFsaXplRGlyZWN0aXZlLnByb3RvdHlwZS5wcmV2aW91c0Rpc2FibGVkO1xuICAgIC8qKiBAdHlwZSB7P30gKi9cbiAgICBNYXRlcmlhbGl6ZURpcmVjdGl2ZS5wcm90b3R5cGUuX3dhaXRGdW5jdGlvbjtcbiAgICAvKiogQHR5cGUgez99ICovXG4gICAgTWF0ZXJpYWxpemVEaXJlY3RpdmUucHJvdG90eXBlLmNoYW5nZUxpc3RlbmVyU2hvdWxkQmVBZGRlZDtcbiAgICAvKiogQHR5cGUgez99ICovXG4gICAgTWF0ZXJpYWxpemVEaXJlY3RpdmUucHJvdG90eXBlLmluaXQ7XG4gICAgLyoqIEB0eXBlIHs/fSAqL1xuICAgIE1hdGVyaWFsaXplRGlyZWN0aXZlLnByb3RvdHlwZS5pbml0aWFsaXplZDtcbiAgICAvKiogQHR5cGUgez99ICovXG4gICAgTWF0ZXJpYWxpemVEaXJlY3RpdmUucHJvdG90eXBlLm5nTW9kZWw7XG4gICAgLyoqIEB0eXBlIHs/fSAqL1xuICAgIE1hdGVyaWFsaXplRGlyZWN0aXZlLnByb3RvdHlwZS5fZWw7XG59XG4iXX0=","map":null,"metadata":{},"sourceType":"module"}